---
title: "Introduction to SJD (Structured Joint Decomposition)"
author: Huan Chen
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{my-vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

SJD (Structured Joint Decomposiiton) is a R package for visualizing biologically structured gene expression matrix environment based on low rank models. Currently, it provides user 4 different styles of decomposition: (1) Separately, (2) Concatenately, (3) Jointly, (4) Sequentially.

To install this package in R, run the following commands:

```R
library(devtools)
install_github("CHuanSite/SJD")
```

This package implements four categories of algorithms to decompose multiple datasets, (1) Separately, (2) Concatenately, (3) Jointly, (4) Two Stage Sequentially. 

For the first three categories, there are three available algorithms: Principal Component Analysis (PCA), Independent Component Analysis (ICA) and Nonnegative Matrix Factorization (NMF). For each method, the algorithm takes three arguments, `dataset`, `group` and `comp_num`, specifying which datasets to be used, what is the structure among the datasets and what's the dimension for each component.

For the last category, there is one algorithm, called two-staged linked component analysis, which is a PCA based statistical model.

```{r setup}
library(SJD)
```

# Example Usage

## Laod data
```{r}
lbb1="NeuroGenesis4"
data("NeuroGenesis4", package = "SJD")
data("NeuroGenesis4.info", package = "SJD")
```

## Transform data
```{r}
PJDdataIN = pjd_wrap(
  data.list = NeuroGenesis4,
  species.vector = c("human", "human", "human", "mouse"),
  geneType.vector = c("symbol","ensembl","symbol","symbol"),
  geneType.out = "symbol",
  species.out = "human")

data.nms=names(NeuroGenesis4)
type.nms=c('Yaxis','Yaxis','2Dscatter','2Dscatter')
XaxisColumn.nms=c("X","DAYx","tSNE_1","tsne1:ch1")
YaxisColumn.nms=c("PJDscores","PJDscores","tSNE_2","tsne2:ch1")
COLaxisColumn.nms=c("color","colorBYlabelsX","PJDscores","PJDscores")
PCHColumn.nms=c("","","","")
SampleMetaNamesTable=data.frame(row.names=data.nms,Type=type.nms,XaxisColumn=XaxisColumn.nms,YaxisColumn=YaxisColumn.nms,COLaxisColumn=COLaxisColumn.nms,PCHColumn=PCHColumn.nms)

```

## Apply two stage LCA
```{r}
grp=list(Shared.All.4=c(1:4),Shared.bulk.2=c(1,2),Shared.sc.2=c(3,4),Hs.Meisnr.1=c(1),Hs.AZ.1=c(2),Gesch.1=c(3),Telley.1=c(4))
dims=c(2,2,2,2,2,2,2)# must have same length as "grp"
lbb2=paste(lbb1,".p",dims[1],sep="")

twoStageLCA.out=twoStageLCA(dataset=PJDdataIN,group=grp,comp_num=dims)
```

